<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Configs - Prompt Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f8fafc;
            color: #334155;
            line-height: 1.6;
        }

        /* Header Styles */
        .header {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
        }

        .nav-menu {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-menu a {
            text-decoration: none;
            color: #64748b;
            font-weight: 500;
            transition: color 0.2s;
        }

        .nav-menu a:hover {
            color: #3b82f6;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .search-box {
            position: relative;
        }

        .search-input {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            width: 250px;
            font-size: 0.875rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-warning {
            background: #f59e0b;
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
        }

        /* Main Content */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .page-title {
            font-size: 1.875rem;
            font-weight: 700;
            color: #1e293b;
        }

        .page-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* Categories Filter */
        .categories-filter {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .category-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 2rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
        }

        .category-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .category-btn:hover {
            border-color: #3b82f6;
        }

        /* Layout Toggle */
        .layout-toggle {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }

        /* Prompts Grid */
        .prompts-grid {
            display: grid;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .prompts-grid.grid-layout {
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        }

        .prompts-grid.list-layout {
            grid-template-columns: 1fr;
        }

        .prompt-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.2s;
            cursor: pointer;
        }

        .prompt-card:hover {
            border-color: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
        }

        .prompt-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #1e293b;
        }

        .prompt-description {
            color: #64748b;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .prompt-category {
            display: inline-block;
            background: #f1f5f9;
            color: #475569;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 2rem;
        }

        .pagination button {
            padding: 0.5rem 0.75rem;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .pagination button:hover {
            background: #f8fafc;
        }

        .pagination button.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 0.75rem;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #64748b;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #374151;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.875rem;
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
        }

        /* Admin Panel Styles */
        .admin-panel {
            display: none;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 250px;
            height: 100vh;
            background: #1e293b;
            color: white;
            padding: 1rem;
            overflow-y: auto;
            z-index: 200;
            transform: translateX(-100%);
            transition: transform 0.3s;
        }

        .admin-sidebar.active {
            transform: translateX(0);
        }

        .admin-content {
            margin-left: 0;
            padding: 2rem;
            transition: margin-left 0.3s;
        }

        .admin-content.sidebar-open {
            margin-left: 250px;
        }

        .sidebar-header {
            padding-bottom: 1rem;
            border-bottom: 1px solid #334155;
            margin-bottom: 1rem;
        }

        .sidebar-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 0.5rem;
        }

        .sidebar-menu a {
            display: block;
            padding: 0.75rem;
            color: #cbd5e1;
            text-decoration: none;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }

        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background: #334155;
            color: white;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Dashboard Cards */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
        }

        .card-title {
            font-size: 0.875rem;
            color: #64748b;
            margin-bottom: 0.5rem;
        }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: #1e293b;
        }

        /* Data Table */
        .data-table {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            overflow: hidden;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th,
        .table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .table th {
            background: #f8fafc;
            font-weight: 600;
            color: #374151;
        }

        .table-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Notifications */
        .notification {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 1rem 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            z-index: 1001;
            transform: translateX(100%);
            transition: transform 0.3s;
            max-width: 400px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left: 4px solid #10b981;
        }

        .notification.error {
            border-left: 4px solid #ef4444;
        }

        .notification.warning {
            border-left: 4px solid #f59e0b;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                align-items: stretch;
            }

            .nav-menu {
                justify-content: center;
            }

            .search-input {
                width: 100%;
            }

            .page-header {
                flex-direction: column;
                align-items: stretch;
            }

            .page-actions {
                justify-content: center;
            }

            .prompts-grid.grid-layout {
                grid-template-columns: 1fr;
            }

            .admin-sidebar {
                width: 100%;
            }

            .admin-content.sidebar-open {
                margin-left: 0;
            }

            .menu-toggle {
                display: block;
            }

            .dashboard-cards {
                grid-template-columns: 1fr;
            }

            .table-responsive {
                overflow-x: auto;
            }
        }

        @media (max-width: 480px) {
            .main-container {
                padding: 1rem 0.5rem;
            }

            .prompt-card {
                padding: 1rem;
            }

            .modal-content {
                padding: 1rem;
                margin: 1rem;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            body {
                background-color: #0f172a;
                color: #e2e8f0;
            }

            .header {
                background: #1e293b;
                border-color: #334155;
            }

            .prompt-card,
            .modal-content,
            .dashboard-card,
            .data-table {
                background: #1e293b;
                border-color: #334155;
            }

            .form-input,
            .form-select,
            .form-textarea {
                background: #334155;
                border-color: #475569;
                color: #e2e8f0;
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <div class="logo">
                <span>🔧</span>
                <span>Network Configs</span>
            </div>
            <nav>
                <ul class="nav-menu">
                    <li><a href="#" onclick="showHome()">Home</a></li>
                    <li><a href="#">Documentation</a></li>
                    <li><a href="#">Support</a></li>
                </ul>
            </nav>
            <div class="header-actions">
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="Search prompts..." id="searchInput">
                </div>
                <button class="btn btn-primary" onclick="showLoginModal()">Login</button>
                <button class="btn btn-secondary" onclick="toggleTheme()">🌙</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="mainContent">
        <div class="main-container">
            <div class="page-header">
                <h1 class="page-title">🎯 Prompt Management</h1>
                <div class="page-actions">
                    <div class="layout-toggle">
                        <button class="btn btn-secondary" onclick="setLayout('grid')" id="gridBtn">Grid</button>
                        <button class="btn btn-secondary" onclick="setLayout('list')" id="listBtn">List</button>
                    </div>
                </div>
            </div>

            <!-- Categories Filter -->
            <div class="categories-filter" id="categoriesFilter">
                <button class="category-btn active" onclick="filterByCategory('all')">All</button>
            </div>

            <!-- Prompts Grid -->
            <div class="prompts-grid grid-layout" id="promptsGrid">
                <!-- Prompts will be loaded here -->
            </div>

            <!-- Pagination -->
            <div class="pagination" id="pagination">
                <!-- Pagination will be loaded here -->
            </div>
        </div>
    </main>

    <!-- Admin Panel -->
    <div id="adminPanel" class="admin-panel">
        <div class="admin-sidebar" id="adminSidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">Admin Panel</h2>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" onclick="showAdminPage('dashboard')" class="active">Dashboard</a></li>
                <li><a href="#" onclick="showAdminPage('prompts')">Prompts</a></li>
                <li><a href="#" onclick="showAdminPage('categories')">Categories</a></li>
                <li><a href="#" onclick="showAdminPage('settings')">Settings</a></li>
            </ul>
        </div>

        <div class="admin-content" id="adminContent">
            <div class="admin-header">
                <button class="menu-toggle" onclick="toggleSidebar()">☰</button>
                <h1 id="adminPageTitle">Dashboard</h1>
                <button class="btn btn-danger" onclick="showExitModal()">Exit</button>
            </div>

            <!-- Dashboard Page -->
            <div id="dashboardPage" class="admin-page">
                <div class="dashboard-cards">
                    <div class="dashboard-card">
                        <div class="card-title">Total Prompts</div>
                        <div class="card-value" id="totalPrompts">0</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-title">Total Categories</div>
                        <div class="card-value" id="totalCategories">0</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-title">Active Users</div>
                        <div class="card-value">1</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-title">System Status</div>
                        <div class="card-value" style="color: #10b981;">Online</div>
                    </div>
                </div>
            </div>

            <!-- Prompts Page -->
            <div id="promptsPage" class="admin-page hidden">
                <div class="page-header">
                    <h2>Manage Prompts</h2>
                    <button class="btn btn-primary" onclick="showAddPromptModal()">Add Prompt</button>
                </div>
                <div class="data-table">
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Description</th>
                                    <th>Category</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="promptsTableBody">
                                <!-- Prompts will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Categories Page -->
            <div id="categoriesPage" class="admin-page hidden">
                <div class="page-header">
                    <h2>Manage Categories</h2>
                    <div class="form-group" style="display: flex; gap: 1rem; align-items: end;">
                        <div style="flex: 1;">
                            <label class="form-label">Category Name</label>
                            <input type="text" class="form-input" id="newCategoryInput" placeholder="Enter category name">
                        </div>
                        <button class="btn btn-primary" onclick="addCategory()">Add</button>
                    </div>
                </div>
                <div class="data-table">
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Prompts Count</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="categoriesTableBody">
                                <!-- Categories will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div id="settingsPage" class="admin-page hidden">
                <h2>Settings</h2>
                <div class="dashboard-cards">
                    <div class="dashboard-card">
                        <h3>Prompts Management</h3>
                        <p>Manage all prompts in the system</p>
                        <div style="margin-top: 1rem;">
                            <button class="btn btn-primary" onclick="showAdminPage('prompts')">Manage</button>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Content Management</h3>
                        <p>Manage website content and settings</p>
                        <div style="margin-top: 1rem;">
                            <button class="btn btn-primary" onclick="showNotification('Content management coming soon!', 'warning')">Manage</button>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Password Management</h3>
                        <p>Change admin password</p>
                        <div style="margin-top: 1rem;">
                            <button class="btn btn-warning" onclick="showChangePasswordModal()">Change Password</button>
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Backup & Restore</h3>
                        <p>Backup and restore system data</p>
                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            <button class="btn btn-success" onclick="createBackup()">Backup</button>
                            <button class="btn btn-primary" onclick="downloadBackup()">Download</button>
                            <button class="btn btn-warning" onclick="showImportModal()">Import</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Admin Login</h2>
                <button class="close-btn" onclick="closeModal('loginModal')">&times;</button>
            </div>
            <form onsubmit="login(event)">
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="loginPassword" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('loginModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Login</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Prompt Modal -->
    <div id="promptModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="promptModalTitle">Add Prompt</h2>
                <button class="close-btn" onclick="closeModal('promptModal')">&times;</button>
            </div>
            <form onsubmit="savePrompt(event)">
                <div class="form-group">
                    <label class="form-label">Name</label>
                    <input type="text" class="form-input" id="promptName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea class="form-textarea" id="promptDescription" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Category</label>
                    <select class="form-select" id="promptCategory" required>
                        <option value="">Select Category</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('promptModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Exit Confirmation Modal -->
    <div id="exitModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Confirm Exit</h2>
                <button class="close-btn" onclick="closeModal('exitModal')">&times;</button>
            </div>
            <p>Are you sure you want to exit?</p>
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="closeModal('exitModal')">Cancel</button>
                <button class="btn btn-danger" onclick="logout()">Exit</button>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Change Password</h2>
                <button class="close-btn" onclick="closeModal('changePasswordModal')">&times;</button>
            </div>
            <form onsubmit="changePassword(event)">
                <div class="form-group">
                    <label class="form-label">Current Password</label>
                    <input type="password" class="form-input" id="currentPassword" required>
                </div>
                <div class="form-group">
                    <label class="form-label">New Password</label>
                    <input type="password" class="form-input" id="newPassword" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Confirm New Password</label>
                    <input type="password" class="form-input" id="confirmPassword" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('changePasswordModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Change Password</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Import Modal -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Import Data</h2>
                <button class="close-btn" onclick="closeModal('importModal')">&times;</button>
            </div>
            <form onsubmit="importData(event)">
                <div class="form-group">
                    <label class="form-label">Select Backup File</label>
                    <input type="file" class="form-input" id="importFile" accept=".json" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('importModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Import</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global Variables
        let currentLayout = 'grid';
        let currentCategory = 'all';
        let currentPage = 1;
        const itemsPerPage = 12;
        let isLoggedIn = false;
        let currentAdminPage = 'dashboard';
        let editingPromptId = null;

        // MD5 Hash Function
        function md5(string) {
            function md5cycle(x, k) {
                var a = x[0], b = x[1], c = x[2], d = x[3];
                a = ff(a, b, c, d, k[0], 7, -680876936);
                d = ff(d, a, b, c, k[1], 12, -389564586);
                c = ff(c, d, a, b, k[2], 17, 606105819);
                b = ff(b, c, d, a, k[3], 22, -1044525330);
                a = ff(a, b, c, d, k[4], 7, -176418897);
                d = ff(d, a, b, c, k[5], 12, 1200080426);
                c = ff(c, d, a, b, k[6], 17, -1473231341);
                b = ff(b, c, d, a, k[7], 22, -45705983);
                a = ff(a, b, c, d, k[8], 7, 1770035416);
                d = ff(d, a, b, c, k[9], 12, -1958414417);
                c = ff(c, d, a, b, k[10], 17, -42063);
                b = ff(b, c, d, a, k[11], 22, -1990404162);
                a = ff(a, b, c, d, k[12], 7, 1804603682);
                d = ff(d, a, b, c, k[13], 12, -40341101);
                c = ff(c, d, a, b, k[14], 17, -1502002290);
                b = ff(b, c, d, a, k[15], 22, 1236535329);
                a = gg(a, b, c, d, k[1], 5, -165796510);
                d = gg(d, a, b, c, k[6], 9, -1069501632);
                c = gg(c, d, a, b, k[11], 14, 643717713);
                b = gg(b, c, d, a, k[0], 20, -373897302);
                a = gg(a, b, c, d, k[5], 5, -701558691);
                d = gg(d, a, b, c, k[10], 9, 38016083);
                c = gg(c, d, a, b, k[15], 14, -660478335);
                b = gg(b, c, d, a, k[4], 20, -405537848);
                a = gg(a, b, c, d, k[9], 5, 568446438);
                d = gg(d, a, b, c, k[14], 9, -1019803690);
                c = gg(c, d, a, b, k[3], 14, -187363961);
                b = gg(b, c, d, a, k[8], 20, 1163531501);
                a = gg(a, b, c, d, k[13], 5, -1444681467);
                d = gg(d, a, b, c, k[2], 9, -51403784);
                c = gg(c, d, a, b, k[7], 14, 1735328473);
                b = gg(b, c, d, a, k[12], 20, -1926607734);
                a = hh(a, b, c, d, k[5], 4, -378558);
                d = hh(d, a, b, c, k[8], 11, -2022574463);
                c = hh(c, d, a, b, k[11], 16, 1839030562);
                b = hh(b, c, d, a, k[14], 23, -35309556);
                a = hh(a, b, c, d, k[1], 4, -1530992060);
                d = hh(d, a, b, c, k[4], 11, 1272893353);
                c = hh(c, d, a, b, k[7], 16, -155497632);
                b = hh(b, c, d, a, k[10], 23, -1094730640);
                a = hh(a, b, c, d, k[13], 4, 681279174);
                d = hh(d, a, b, c, k[0], 11, -358537222);
                c = hh(c, d, a, b, k[3], 16, -722521979);
                b = hh(b, c, d, a, k[6], 23, 76029189);
                a = hh(a, b, c, d, k[9], 4, -640364487);
                d = hh(d, a, b, c, k[12], 11, -421815835);
                c = hh(c, d, a, b, k[15], 16, 530742520);
                b = hh(b, c, d, a, k[2], 23, -995338651);
                a = ii(a, b, c, d, k[0], 6, -198630844);
                d = ii(d, a, b, c, k[7], 10, 1126891415);
                c = ii(c, d, a, b, k[14], 15, -1416354905);
                b = ii(b, c, d, a, k[5], 21, -57434055);
                a = ii(a, b, c, d, k[12], 6, 1700485571);
                d = ii(d, a, b, c, k[3], 10, -1894986606);
                c = ii(c, d, a, b, k[10], 15, -1051523);
                b = ii(b, c, d, a, k[1], 21, -2054922799);
                a = ii(a, b, c, d, k[8], 6, 1873313359);
                d = ii(d, a, b, c, k[15], 10, -30611744);
                c = ii(c, d, a, b, k[6], 15, -1560198380);
                b = ii(b, c, d, a, k[13], 21, 1309151649);
                a = ii(a, b, c, d, k[4], 6, -145523070);
                d = ii(d, a, b, c, k[11], 10, -1120210379);
                c = ii(c, d, a, b, k[2], 15, 718787259);
                b = ii(b, c, d, a, k[9], 21, -343485551);
                x[0] = add32(a, x[0]);
                x[1] = add32(b, x[1]);
                x[2] = add32(c, x[2]);
                x[3] = add32(d, x[3]);
            }

            function cmn(q, a, b, x, s, t) {
                a = add32(add32(a, q), add32(x, t));
                return add32((a << s) | (a >>> (32 - s)), b);
            }

            function ff(a, b, c, d, x, s, t) {
                return cmn((b & c) | ((~b) & d), a, b, x, s, t);
            }

            function gg(a, b, c, d, x, s, t) {
                return cmn((b & d) | (c & (~d)), a, b, x, s, t);
            }

            function hh(a, b, c, d, x, s, t) {
                return cmn(b ^ c ^ d, a, b, x, s, t);
            }

            function ii(a, b, c, d, x, s, t) {
                return cmn(c ^ (b | (~d)), a, b, x, s, t);
            }

            function md51(s) {
                var n = s.length,
                    state = [1732584193, -271733879, -1732584194, 271733878], i;
                for (i = 64; i <= s.length; i += 64) {
                    md5cycle(state, md5blk(s.substring(i - 64, i)));
                }
                s = s.substring(i - 64);
                var tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                for (i = 0; i < s.length; i++)
                    tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);
                tail[i >> 2] |= 0x80 << ((i % 4) << 3);
                if (i > 55) {
                    md5cycle(state, tail);
                    for (i = 0; i < 16; i++) tail[i] = 0;
                }
                tail[14] = n * 8;
                md5cycle(state, tail);
                return state;
            }

            function md5blk(s) {
                var md5blks = [], i;
                for (i = 0; i < 64; i += 4) {
                    md5blks[i >> 2] = s.charCodeAt(i)
                        + (s.charCodeAt(i + 1) << 8)
                        + (s.charCodeAt(i + 2) << 16)
                        + (s.charCodeAt(i + 3) << 24);
                }
                return md5blks;
            }

            function rhex(n) {
                var hex_chr = '0123456789abcdef'.split('');
                var s = '', j = 0;
                for (; j < 4; j++)
                    s += hex_chr[(n >> (j * 8 + 4)) & 0x0F]
                        + hex_chr[(n >> (j * 8)) & 0x0F];
                return s;
            }

            function hex(x) {
                for (var i = 0; i < x.length; i++)
                    x[i] = rhex(x[i]);
                return x.join('');
            }

            function add32(a, b) {
                return (a + b) & 0xFFFFFFFF;
            }

            return hex(md51(string));
        }

        // Local Storage Management
        class LocalStorage {
            static get(key, defaultValue = null) {
                try {
                    const item = localStorage.getItem(key);
                    return item ? JSON.parse(item) : defaultValue;
                } catch (error) {
                    console.error('Error getting from localStorage:', error);
                    return defaultValue;
                }
            }

            static set(key, value) {
                try {
                    localStorage.setItem(key, JSON.stringify(value));
                } catch (error) {
                    console.error('Error setting to localStorage:', error);
                }
            }

            static remove(key) {
                try {
                    localStorage.removeItem(key);
                } catch (error) {
                    console.error('Error removing from localStorage:', error);
                }
            }
        }

        // Data Management
        class DataManager {
            static getPrompts() {
                return LocalStorage.get('prompts', []);
            }

            static setPrompts(prompts) {
                LocalStorage.set('prompts', prompts);
            }

            static getCategories() {
                return LocalStorage.get('categories', ['General', 'Development', 'Marketing', 'Writing']);
            }

            static setCategories(categories) {
                LocalStorage.set('categories', categories);
            }

            static addPrompt(prompt) {
                const prompts = this.getPrompts();
                prompt.id = Date.now().toString();
                prompts.push(prompt);
                this.setPrompts(prompts);
                return prompt;
            }

            static updatePrompt(id, updatedPrompt) {
                const prompts = this.getPrompts();
                const index = prompts.findIndex(p => p.id === id);
                if (index !== -1) {
                    prompts[index] = { ...prompts[index], ...updatedPrompt };
                    this.setPrompts(prompts);
                    return prompts[index];
                }
                return null;
            }

            static deletePrompt(id) {
                const prompts = this.getPrompts();
                const filteredPrompts = prompts.filter(p => p.id !== id);
                this.setPrompts(filteredPrompts);
            }

            static addCategory(category) {
                const categories = this.getCategories();
                if (!categories.includes(category)) {
                    categories.push(category);
                    this.setCategories(categories);
                    return true;
                }
                return false;
            }

            static deleteCategory(category) {
                const categories = this.getCategories();
                const filteredCategories = categories.filter(c => c !== category);
                this.setCategories(filteredCategories);
                
                // Update prompts that use this category
                const prompts = this.getPrompts();
                const updatedPrompts = prompts.map(p => 
                    p.category === category ? { ...p, category: 'General' } : p
                );
                this.setPrompts(updatedPrompts);
            }
        }

        // Initialize default data
        function initializeDefaultData() {
            const prompts = DataManager.getPrompts();
            if (prompts.length === 0) {
                const defaultPrompts = [
                    {
                        id: '1',
                        name: 'Code Review Assistant',
                        description: 'Help review code for best practices, bugs, and improvements.',
                        category: 'Development'
                    },
                    {
                        id: '2',
                        name: 'Marketing Copy Generator',
                        description: 'Generate compelling marketing copy for products and services.',
                        category: 'Marketing'
                    },
                    {
                        id: '3',
                        name: 'Technical Documentation Writer',
                        description: 'Create clear and comprehensive technical documentation.',
                        category: 'Writing'
                    },
                    {
                        id: '4',
                        name: 'Bug Report Analyzer',
                        description: 'Analyze bug reports and suggest solutions.',
                        category: 'Development'
                    },
                    {
                        id: '5',
                        name: 'Content Strategy Planner',
                        description: 'Plan content strategy for social media and blogs.',
                        category: 'Marketing'
                    },
                    {
                        id: '6',
                        name: 'API Documentation Generator',
                        description: 'Generate comprehensive API documentation.',
                        category: 'Development'
                    }
                ];
                DataManager.setPrompts(defaultPrompts);
            }
        }

        // UI Functions
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type} show`;
            notification.innerHTML = `
                <div style="font-weight: 600; margin-bottom: 0.25rem;">${type.charAt(0).toUpperCase() + type.slice(1)}</div>
                <div>${message}</div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 5000);
        }

        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function showLoginModal() {
            showModal('loginModal');
        }

        function showExitModal() {
            showModal('exitModal');
        }

        function showAddPromptModal() {
            editingPromptId = null;
            document.getElementById('promptModalTitle').textContent = 'Add Prompt';
            document.getElementById('promptName').value = '';
            document.getElementById('promptDescription').value = '';
            document.getElementById('promptCategory').value = '';
            loadCategoriesIntoSelect();
            showModal('promptModal');
        }

        function showEditPromptModal(id) {
            const prompts = DataManager.getPrompts();
            const prompt = prompts.find(p => p.id === id);
            if (prompt) {
                editingPromptId = id;
                document.getElementById('promptModalTitle').textContent = 'Edit Prompt';
                document.getElementById('promptName').value = prompt.name;
                document.getElementById('promptDescription').value = prompt.description;
                document.getElementById('promptCategory').value = prompt.category;
                loadCategoriesIntoSelect();
                showModal('promptModal');
            }
        }

        function showChangePasswordModal() {
            showModal('changePasswordModal');
        }

        function showImportModal() {
            showModal('importModal');
        }

        // Authentication
        function login(event) {
            event.preventDefault();
            const password = document.getElementById('loginPassword').value;
            const hashedPassword = md5(password);
            const correctHash = md5('R00T522166#ARIA*PRO#');
            
            if (hashedPassword === correctHash) {
                isLoggedIn = true;
                closeModal('loginModal');
                showAdminPanel();
                showNotification('Login successful!', 'success');
            } else {
                showNotification('Invalid password!', 'error');
            }
        }

        function logout() {
            isLoggedIn = false;
            closeModal('exitModal');
            showHome();
            showNotification('Logged out successfully!', 'success');
        }

        function changePassword(event) {
            event.preventDefault();
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            const currentHash = md5(currentPassword);
            const correctHash = md5('R00T522166#ARIA*PRO#');
            
            if (currentHash !== correctHash) {
                showNotification('Current password is incorrect!', 'error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showNotification('New passwords do not match!', 'error');
                return;
            }
            
            if (newPassword.length < 6) {
                showNotification('New password must be at least 6 characters long!', 'error');
                return;
            }
            
            // In a real application, you would update the password in the database
            // For this demo, we'll just show a success message
            closeModal('changePasswordModal');
            showNotification('Password changed successfully!', 'success');
        }

        // Navigation
        function showHome() {
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('adminPanel').classList.remove('active');
            loadPrompts();
            loadCategories();
        }

        function showAdminPanel() {
            if (!isLoggedIn) {
                showLoginModal();
                return;
            }
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('adminPanel').classList.add('active');
            document.getElementById('adminSidebar').classList.add('active');
            document.getElementById('adminContent').classList.add('sidebar-open');
            showAdminPage('dashboard');
        }

        function showAdminPage(page) {
            // Hide all admin pages
            document.querySelectorAll('.admin-page').forEach(p => p.classList.add('hidden'));
            
            // Show selected page
            document.getElementById(page + 'Page').classList.remove('hidden');
            
            // Update sidebar active state
            document.querySelectorAll('.sidebar-menu a').forEach(a => a.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update page title
            document.getElementById('adminPageTitle').textContent = 
                page.charAt(0).toUpperCase() + page.slice(1);
            
            currentAdminPage = page;
            
            // Load page-specific data
            switch(page) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'prompts':
                    loadPromptsTable();
                    break;
                case 'categories':
                    loadCategoriesTable();
                    break;
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('adminSidebar');
            const content = document.getElementById('adminContent');
            
            sidebar.classList.toggle('active');
            content.classList.toggle('sidebar-open');
        }

        // Layout and Filtering
        function setLayout(layout) {
            currentLayout = layout;
            const grid = document.getElementById('promptsGrid');
            const gridBtn = document.getElementById('gridBtn');
            const listBtn = document.getElementById('listBtn');
            
            if (layout === 'grid') {
                grid.className = 'prompts-grid grid-layout';
                gridBtn.classList.add('btn-primary');
                gridBtn.classList.remove('btn-secondary');
                listBtn.classList.add('btn-secondary');
                listBtn.classList.remove('btn-primary');
            } else {
                grid.className = 'prompts-grid list-layout';
                listBtn.classList.add('btn-primary');
                listBtn.classList.remove('btn-secondary');
                gridBtn.classList.add('btn-secondary');
                gridBtn.classList.remove('btn-primary');
            }
        }

        function filterByCategory(category) {
            currentCategory = category;
            currentPage = 1;
            
            // Update active category button
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            loadPrompts();
        }

        // Data Loading Functions
        function loadPrompts() {
            const prompts = DataManager.getPrompts();
            let filteredPrompts = prompts;
            
            // Filter by category
            if (currentCategory !== 'all') {
                filteredPrompts = prompts.filter(p => p.category === currentCategory);
            }
            
            // Filter by search
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            if (searchTerm) {
                filteredPrompts = filteredPrompts.filter(p => 
                    p.name.toLowerCase().includes(searchTerm) || 
                    p.description.toLowerCase().includes(searchTerm)
                );
            }
            
            // Pagination
            const totalPages = Math.ceil(filteredPrompts.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedPrompts = filteredPrompts.slice(startIndex, endIndex);
            
            // Render prompts
            const grid = document.getElementById('promptsGrid');
            grid.innerHTML = paginatedPrompts.map(prompt => `
                <div class="prompt-card">
                    <h3 class="prompt-title">${prompt.name}</h3>
                    <p class="prompt-description">${prompt.description}</p>
                    <span class="prompt-category">${prompt.category}</span>
                </div>
            `).join('');
            
            // Render pagination
            renderPagination(totalPages);
        }

        function loadCategories() {
            const categories = DataManager.getCategories();
            const filter = document.getElementById('categoriesFilter');
            
            filter.innerHTML = `
                <button class="category-btn ${currentCategory === 'all' ? 'active' : ''}" onclick="filterByCategory('all')">All</button>
                ${categories.map(category => `
                    <button class="category-btn ${currentCategory === category ? 'active' : ''}" onclick="filterByCategory('${category}')">${category}</button>
                `).join('')}
            `;
        }

        function loadCategoriesIntoSelect() {
            const categories = DataManager.getCategories();
            const select = document.getElementById('promptCategory');
            
            select.innerHTML = `
                <option value="">Select Category</option>
                ${categories.map(category => `
                    <option value="${category}">${category}</option>
                `).join('')}
            `;
        }

        function loadDashboardData() {
            const prompts = DataManager.getPrompts();
            const categories = DataManager.getCategories();
            
            document.getElementById('totalPrompts').textContent = prompts.length;
            document.getElementById('totalCategories').textContent = categories.length;
        }

        function loadPromptsTable() {
            const prompts = DataManager.getPrompts();
            const tbody = document.getElementById('promptsTableBody');
            
            tbody.innerHTML = prompts.map(prompt => `
                <tr>
                    <td>${prompt.name}</td>
                    <td>${prompt.description.substring(0, 100)}${prompt.description.length > 100 ? '...' : ''}</td>
                    <td>${prompt.category}</td>
                    <td class="table-actions">
                        <button class="btn btn-warning" onclick="showEditPromptModal('${prompt.id}')">Edit</button>
                        <button class="btn btn-danger" onclick="deletePrompt('${prompt.id}')">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        function loadCategoriesTable() {
            const categories = DataManager.getCategories();
            const prompts = DataManager.getPrompts();
            const tbody = document.getElementById('categoriesTableBody');
            
            tbody.innerHTML = categories.map(category => {
                const promptCount = prompts.filter(p => p.category === category).length;
                return `
                    <tr>
                        <td>${category}</td>
                        <td>${promptCount}</td>
                        <td class="table-actions">
                            <button class="btn btn-warning" onclick="editCategory('${category}')">Edit</button>
                            <button class="btn btn-secondary" onclick="duplicateCategory('${category}')">Duplicate</button>
                            <button class="btn btn-danger" onclick="deleteCategory('${category}')">Delete</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function renderPagination(totalPages) {
            const pagination = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }
            
            let paginationHTML = '';
            
            // Previous button
            paginationHTML += `
                <button onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
                    Previous
                </button>
            `;
            
            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                if (i === currentPage || i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                    paginationHTML += `
                        <button onclick="changePage(${i})" class="${i === currentPage ? 'active' : ''}">
                            ${i}
                        </button>
                    `;
                } else if (i === currentPage - 2 || i === currentPage + 2) {
                    paginationHTML += '<span>...</span>';
                }
            }
            
            // Next button
            paginationHTML += `
                <button onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
                    Next
                </button>
            `;
            
            pagination.innerHTML = paginationHTML;
        }

        function changePage(page) {
            const prompts = DataManager.getPrompts();
            let filteredPrompts = prompts;
            
            if (currentCategory !== 'all') {
                filteredPrompts = prompts.filter(p => p.category === currentCategory);
            }
            
            const totalPages = Math.ceil(filteredPrompts.length / itemsPerPage);
            
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                loadPrompts();
            }
        }

        // CRUD Operations
        function savePrompt(event) {
            event.preventDefault();
            
            const name = document.getElementById('promptName').value;
            const description = document.getElementById('promptDescription').value;
            const category = document.getElementById('promptCategory').value;
            
            const promptData = { name, description, category };
            
            if (editingPromptId) {
                DataManager.updatePrompt(editingPromptId, promptData);
                showNotification('Prompt updated successfully!', 'success');
            } else {
                DataManager.addPrompt(promptData);
                showNotification('Prompt added successfully!', 'success');
            }
            
            closeModal('promptModal');
            
            if (currentAdminPage === 'prompts') {
                loadPromptsTable();
            }
            
            loadPrompts();
            loadDashboardData();
        }

        function deletePrompt(id) {
            if (confirm('Are you sure you want to delete this prompt?')) {
                DataManager.deletePrompt(id);
                showNotification('Prompt deleted successfully!', 'success');
                
                if (currentAdminPage === 'prompts') {
                    loadPromptsTable();
                }
                
                loadPrompts();
                loadDashboardData();
            }
        }

        function addCategory() {
            const categoryName = document.getElementById('newCategoryInput').value.trim();
            
            if (!categoryName) {
                showNotification('Please enter a category name!', 'error');
                return;
            }
            
            if (DataManager.addCategory(categoryName)) {
                document.getElementById('newCategoryInput').value = '';
                loadCategoriesTable();
                loadCategories();
                loadDashboardData();
                showNotification('Category added successfully!', 'success');
            } else {
                showNotification('Category already exists!', 'error');
            }
        }

        function editCategory(category) {
            const newName = prompt('Enter new category name:', category);
            if (newName && newName !== category) {
                const categories = DataManager.getCategories();
                const index = categories.indexOf(category);
                if (index !== -1) {
                    categories[index] = newName;
                    DataManager.setCategories(categories);
                    
                    // Update prompts with the new category name
                    const prompts = DataManager.getPrompts();
                    const updatedPrompts = prompts.map(p => 
                        p.category === category ? { ...p, category: newName } : p
                    );
                    DataManager.setPrompts(updatedPrompts);
                    
                    loadCategoriesTable();
                    loadCategories();
                    showNotification('Category updated successfully!', 'success');
                }
            }
        }

        function duplicateCategory(category) {
            const newName = prompt('Enter name for duplicated category:', category + ' Copy');
            if (newName && DataManager.addCategory(newName)) {
                loadCategoriesTable();
                loadCategories();
                loadDashboardData();
                showNotification('Category duplicated successfully!', 'success');
            } else if (newName) {
                showNotification('Category already exists!', 'error');
            }
        }

        function deleteCategory(category) {
            if (confirm(`Are you sure you want to delete the category "${category  {
            if (confirm(`Are you sure you want to delete the category "${category}"? All prompts in this category will be moved to "General".`)) {
                DataManager.deleteCategory(category);
                loadCategoriesTable();
                loadCategories();
                loadDashboardData();
                showNotification('Category deleted successfully!', 'success');
            }
        }

        // Backup and Import Functions
        function createBackup() {
            const data = {
                prompts: DataManager.getPrompts(),
                categories: DataManager.getCategories(),
                timestamp: new Date().toISOString(),
                version: '1.0'
            };
            
            LocalStorage.set('backup', data);
            showNotification('Backup created successfully!', 'success');
        }

        function downloadBackup() {
            const data = {
                prompts: DataManager.getPrompts(),
                categories: DataManager.getCategories(),
                timestamp: new Date().toISOString(),
                version: '1.0'
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `network-configs-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Backup downloaded successfully!', 'success');
        }

        function importData(event) {
            event.preventDefault();
            
            const fileInput = document.getElementById('importFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showNotification('Please select a file to import!', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (data.prompts && data.categories) {
                        DataManager.setPrompts(data.prompts);
                        DataManager.setCategories(data.categories);
                        
                        closeModal('importModal');
                        loadDashboardData();
                        loadPromptsTable();
                        loadCategoriesTable();
                        loadPrompts();
                        loadCategories();
                        
                        showNotification('Data imported successfully!', 'success');
                    } else {
                        showNotification('Invalid backup file format!', 'error');
                    }
                } catch (error) {
                    showNotification('Error reading backup file!', 'error');
                }
            };
            
            reader.readAsText(file);
        }

        // Theme Toggle
        function toggleTheme() {
            const body = document.body;
            const isDark = body.classList.contains('dark-theme');
            
            if (isDark) {
                body.classList.remove('dark-theme');
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.add('dark-theme');
                localStorage.setItem('theme', 'dark');
            }
        }

        // Search Functionality
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            let searchTimeout;
            
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    currentPage = 1;
                    loadPrompts();
                }, 300);
            });
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize default data
            initializeDefaultData();
            
            // Load initial data
            loadPrompts();
            loadCategories();
            
            // Setup search
            setupSearch();
            
            // Load saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
            }
            
            // Close modals when clicking outside
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        modal.classList.remove('active');
                    }
                });
            });
            
            // Handle escape key to close modals
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    document.querySelectorAll('.modal.active').forEach(modal => {
                        modal.classList.remove('active');
                    });
                }
            });
            
            // Handle responsive sidebar
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    document.getElementById('adminSidebar').classList.add('active');
                    document.getElementById('adminContent').classList.add('sidebar-open');
                } else {
                    document.getElementById('adminSidebar').classList.remove('active');
                    document.getElementById('adminContent').classList.remove('sidebar-open');
                }
            });
        });

        // Utility Functions
        function generateId() {
            return Date.now().toString() + Math.random().toString(36).substr(2, 9);
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
        }

        function truncateText(text, maxLength) {
            if (text.length <= maxLength) return text;
            return text.substr(0, maxLength) + '...';
        }

        // Performance Optimization
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Error Handling
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.error);
            showNotification('An unexpected error occurred. Please try again.', 'error');
        });

        // Service Worker Registration (for offline functionality)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(function(err) {
                        console.log('ServiceWorker registration failed');
                    });
            });
        }
    </script>
</body>
</html>
